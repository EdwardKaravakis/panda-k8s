# server configuration json
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "server.fullname" . }}-configjson
data:
  panda_server_configmap.json: |-
{{ .Files.Get "panda_server_configmap.json" | indent 4}}

{{- if .Values.hostcerts.enabled }}
---
# host cert and key
apiVersion: v1
kind: ConfigMap
metadata:
    name: {{ include "server.fullname" . }}-certs
data:
    hostcert.pem: |-
{{ .Files.Get "hostcert.pem" | indent 8}}

    hostkey.pem: |-
{{ .Files.Get "hostkey.pem" | indent 8}}
{{- end }}

---

# server configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "server.fullname" . }}-configmap
data:
  PANDA_URL: "https://{{ include "server.fullname" .}}:{{ .Values.service.httpsPort }}/server/panda"
  PANDA_URL_SSL: "https://{{ include "server.fullname" .}}:{{ .Values.service.httpsPort }}/server/panda"
